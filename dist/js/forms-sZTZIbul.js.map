{"version":3,"file":"forms-sZTZIbul.js","sources":["../../assets/js/forms.js"],"sourcesContent":["/**\n * Hoplytics AJAX Forms â€” fetch-based form submission to REST API.\n *\n * Handles hero lead form and SEO audit form with inline feedback\n * and loading states. Falls back gracefully when JS is disabled.\n *\n * @package Hoplytics\n */\n\n(function () {\n    'use strict';\n\n    const API_BASE = window.hoplyticsApi?.restUrl ?? '/wp-json/hoplytics/v1';\n    const NONCE = window.hoplyticsApi?.nonce ?? '';\n\n    /**\n     * Submit a form via REST API with loading states and inline feedback.\n     *\n     * @param {HTMLFormElement} form\n     * @param {string}         endpoint\n     * @param {Function}       getData   Returns an object of form values.\n     */\n    const handleForm = async (form, endpoint, getData) => {\n        const btn = form.querySelector('button[type=\"submit\"]');\n        const origText = btn?.textContent ?? 'Submit';\n\n        // Set loading state\n        if (btn) {\n            btn.disabled = true;\n            btn.textContent = 'Sending...';\n        }\n\n        // Remove old feedback\n        const oldMsg = form.querySelector('.form-feedback');\n        if (oldMsg) oldMsg.remove();\n\n        try {\n            const response = await fetch(`${API_BASE}/${endpoint}`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-WP-Nonce': NONCE,\n                },\n                body: JSON.stringify(getData()),\n            });\n\n            const data = await response.json();\n            const isSuccess = response.ok && data.success;\n\n            // Show inline message\n            const msg = document.createElement('div');\n            msg.className = `form-feedback ${isSuccess ? 'form-success' : 'form-error'}`;\n            msg.setAttribute('role', 'alert');\n            msg.textContent = data.message || (isSuccess ? 'Submitted!' : 'Something went wrong.');\n            form.appendChild(msg);\n\n            if (isSuccess) {\n                form.reset();\n            }\n        } catch {\n            const msg = document.createElement('div');\n            msg.className = 'form-feedback form-error';\n            msg.setAttribute('role', 'alert');\n            msg.textContent = 'Network error. Please try again.';\n            form.appendChild(msg);\n        } finally {\n            if (btn) {\n                btn.disabled = false;\n                btn.textContent = origText;\n            }\n        }\n    };\n\n    // --- Hero Lead Form ---\n    const heroForm = document.querySelector('.hero-application-form');\n    if (heroForm) {\n        heroForm.addEventListener('submit', (e) => {\n            e.preventDefault();\n            handleForm(heroForm, 'lead', () => ({\n                name: heroForm.querySelector('[name=\"name\"]')?.value ?? '',\n                email: heroForm.querySelector('[name=\"email\"]')?.value ?? '',\n                website: heroForm.querySelector('[name=\"website_url\"]')?.value ?? '',\n                budget: heroForm.querySelector('[name=\"ad_budget\"]')?.value ?? '',\n            }));\n        });\n    }\n\n    // --- SEO Audit Form ---\n    const auditForm = document.querySelector('.seo-audit-form');\n    if (auditForm) {\n        auditForm.addEventListener('submit', (e) => {\n            e.preventDefault();\n            handleForm(auditForm, 'seo-audit', () => ({\n                url: auditForm.querySelector('[name=\"audit_url\"]')?.value ?? '',\n                email: auditForm.querySelector('[name=\"audit_email\"]')?.value ?? '',\n            }));\n        });\n    }\n})();\n"],"names":["_a","_b","API_BASE","NONCE","handleForm","form","endpoint","getData","btn","origText","oldMsg","response","data","isSuccess","msg","heroForm","e","_c","_d","auditForm"],"mappings":"CASC,UAAY,CATb,IAAAA,EAAAC,EAYI,MAAMC,IAAWF,EAAA,OAAO,eAAP,YAAAA,EAAqB,UAAW,wBAC3CG,IAAQF,EAAA,OAAO,eAAP,YAAAA,EAAqB,QAAS,GAStCG,EAAa,MAAOC,EAAMC,EAAUC,IAAY,CAClD,MAAMC,EAAMH,EAAK,cAAc,uBAAuB,EAChDI,GAAWD,GAAA,YAAAA,EAAK,cAAe,SAGjCA,IACAA,EAAI,SAAW,GACfA,EAAI,YAAc,cAItB,MAAME,EAASL,EAAK,cAAc,gBAAgB,EAC9CK,GAAQA,EAAO,OAAM,EAEzB,GAAI,CACA,MAAMC,EAAW,MAAM,MAAM,GAAGT,CAAQ,IAAII,CAAQ,GAAI,CACpD,OAAQ,OACR,QAAS,CACL,eAAgB,mBAChB,aAAcH,CAClC,EACgB,KAAM,KAAK,UAAUI,GAAS,CAC9C,CAAa,EAEKK,EAAO,MAAMD,EAAS,KAAI,EAC1BE,EAAYF,EAAS,IAAMC,EAAK,QAGhCE,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,UAAY,iBAAiBD,EAAY,eAAiB,YAAY,GAC1EC,EAAI,aAAa,OAAQ,OAAO,EAChCA,EAAI,YAAcF,EAAK,UAAYC,EAAY,aAAe,yBAC9DR,EAAK,YAAYS,CAAG,EAEhBD,GACAR,EAAK,MAAK,CAElB,MAAQ,CACJ,MAAMS,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,UAAY,2BAChBA,EAAI,aAAa,OAAQ,OAAO,EAChCA,EAAI,YAAc,mCAClBT,EAAK,YAAYS,CAAG,CACxB,QAAC,CACON,IACAA,EAAI,SAAW,GACfA,EAAI,YAAcC,EAE1B,CACJ,EAGMM,EAAW,SAAS,cAAc,wBAAwB,EAC5DA,GACAA,EAAS,iBAAiB,SAAWC,GAAM,CACvCA,EAAE,eAAc,EAChBZ,EAAWW,EAAU,OAAQ,IAAA,CA9EzC,IAAAf,EAAAC,EAAAgB,EAAAC,EA8EgD,OAChC,OAAMlB,EAAAe,EAAS,cAAc,eAAe,IAAtC,YAAAf,EAAyC,QAAS,GACxD,QAAOC,EAAAc,EAAS,cAAc,gBAAgB,IAAvC,YAAAd,EAA0C,QAAS,GAC1D,UAASgB,EAAAF,EAAS,cAAc,sBAAsB,IAA7C,YAAAE,EAAgD,QAAS,GAClE,SAAQC,EAAAH,EAAS,cAAc,oBAAoB,IAA3C,YAAAG,EAA8C,QAAS,EAC/E,EAAc,CACN,CAAC,EAIL,MAAMC,EAAY,SAAS,cAAc,iBAAiB,EACtDA,GACAA,EAAU,iBAAiB,SAAWH,GAAM,CACxCA,EAAE,eAAc,EAChBZ,EAAWe,EAAW,YAAa,IAAA,CA5F/C,IAAAnB,EAAAC,EA4FsD,OACtC,MAAKD,EAAAmB,EAAU,cAAc,oBAAoB,IAA5C,YAAAnB,EAA+C,QAAS,GAC7D,QAAOC,EAAAkB,EAAU,cAAc,sBAAsB,IAA9C,YAAAlB,EAAiD,QAAS,EACjF,EAAc,CACN,CAAC,CAET,GAAC"}