/* ==========================================================================
   #Accessibility & WCAG 2.1 AA
   ========================================================================== */

/**
 * Focus Visible — WCAG 2.4.7 Focus Visible
 * Consistent, high-contrast focus ring on all interactive elements.
 * Uses :focus-visible to avoid showing on mouse clicks.
 */
:focus-visible {
    outline: 2px solid var(--color-accent, #3B82F6);
    outline-offset: 2px;
}

/* Buttons */
.btn:focus-visible,
.wp-block-button__link:focus-visible,
button:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.25);
}

/* Links */
a:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
    border-radius: 2px;
}

/* Cards — show focus ring when navigating via keyboard */
.card:focus-visible,
.content-card:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 4px;
}

/* Range Sliders — WCAG fix: NEVER use outline:none */
input[type=range]:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 4px;
}

input[type=range]:focus-visible::-webkit-slider-thumb {
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4);
}

input[type=range]:focus-visible::-moz-range-thumb {
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4);
}

/* Form inputs */
textarea:focus-visible,
select:focus-visible,
input:not([type=range]):focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 0;
    border-color: transparent;
}

/**
 * Skip Link — WCAG 2.4.1
 * Enhanced styling for the existing screen-reader skip link.
 */
.skip-link.screen-reader-text {
    clip: rect(1px, 1px, 1px, 1px);
    position: absolute !important;
    width: 1px;
    height: 1px;
    overflow: hidden;
    word-wrap: normal !important;
}

.skip-link.screen-reader-text:focus {
    clip: auto !important;
    display: block;
    top: 5px;
    left: 5px;
    width: auto;
    height: auto;
    padding: 15px 23px 14px;
    background: var(--color-primary);
    color: #fff;
    font-size: 1rem;
    font-weight: 600;
    text-decoration: none;
    z-index: 100000;
    border-radius: var(--radius-md);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

/**
 * Reduced Motion — WCAG 2.3.3
 * Respects user preference for reduced motion.
 */
@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .card:hover {
        transform: none;
    }

    .logo-grid img:hover {
        transform: none;
    }

    .main-navigation {
        transition: none;
    }
}

/**
 * Screen Reader Only — utility class for a11y text.
 */
.sr-only {
    clip: rect(0, 0, 0, 0);
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    white-space: nowrap;
    border: 0;
}

/**
 * ARIA live region feedback styles.
 */
.form-feedback {
    padding: 0.75rem 1rem;
    border-radius: var(--radius-md);
    margin-top: 1rem;
    font-size: 0.9rem;
    font-weight: 500;
}

.form-success {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid #10B981;
    color: #065F46;
}

.form-error {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid #EF4444;
    color: #991B1B;
}

/* Dark kits: invert feedback text */
body.style-kit-tech-futurist .form-success {
    color: #A7F3D0;
}

body.style-kit-tech-futurist .form-error {
    color: #FCA5A5;
}

/* ==========================================================================
   #Dark Mode Toggle
   ========================================================================== */

/**
 * Dark mode system: works with `data-theme="dark"` on <html>.
 * Respects OS preference via prefers-color-scheme when no explicit toggle.
 */

/* Toggle button styling */
.dark-mode-toggle {
    background: none;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: 0.4rem 0.6rem;
    cursor: pointer;
    font-size: 1.1rem;
    line-height: 1;
    color: var(--color-text);
    transition: background 0.2s ease;
}

.dark-mode-toggle:hover {
    background: var(--color-bg-alt);
}

.dark-mode-toggle:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
}

/* OS-level dark mode preference (when no explicit toggle set) */
@media (prefers-color-scheme: dark) {
    html:not([data-theme="light"]) body:not(.style-kit-tech-futurist):not([class*="style-kit-"]) {
        --color-bg: #0B0F19;
        --color-bg-alt: #111827;
        --color-text: #F3F4F6;
        --color-text-muted: #9CA3AF;
        --color-border: #1F2937;
    }
}

/* Explicit dark mode via toggle */
html[data-theme="dark"] body {
    --color-bg: #0B0F19;
    --color-bg-alt: #111827;
    --color-text: #F3F4F6;
    --color-text-muted: #9CA3AF;
    --color-primary: #3B82F6;
    --color-accent: #10B981;
    --color-border: #1F2937;
    background-color: #0B0F19;
}

html[data-theme="dark"] .site-header {
    background: rgba(11, 15, 25, 0.9);
}

html[data-theme="dark"] .form-success {
    color: #A7F3D0;
}

html[data-theme="dark"] .form-error {
    color: #FCA5A5;
}

/* Explicit light mode via toggle */
html[data-theme="light"] body:not([class*="style-kit-"]) {
    --color-bg: #FFFFFF;
    --color-bg-alt: #F8FAFC;
    --color-text: #334155;
    --color-text-muted: #64748B;
    --color-border: #E2E8F0;
    background-color: #FFFFFF;
}

/* ==========================================================================
   #View Transitions API
   ========================================================================== */

/**
 * Enables smooth cross-page transitions in supported browsers (Chrome 111+).
 * Combined with the <meta> tag in performance.php.
 */
@view-transition {
    navigation: auto;
}

::view-transition-old(root),
::view-transition-new(root) {
    animation-duration: 0.25s;
}

::view-transition-old(root) {
    animation: fade-out 0.15s ease-in;
}

::view-transition-new(root) {
    animation: fade-in 0.2s ease-out;
}

@keyframes fade-out {
    from {
        opacity: 1;
    }

    to {
        opacity: 0;
    }
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}